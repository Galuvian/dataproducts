<!DOCTYPE html>
<html>
<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="chrome=1" http-equiv="X-UA-Compatible">
  <title>Pitch for Military Surplus Visualization</title>
  <meta content="Pitch for Military Surplus Visualization" name="description">
  <meta content="John Lavoie" name="author">
  <meta content="slidify" name="generator">
  <!-- STYLESHEETS -->
  <link href="libraries/frameworks/landslide/themes/default/css/print.css" 
    media="print" rel="stylesheet">
  <link href="libraries/frameworks/landslide/themes/default/css/screen.css" 
    media="screen, projection" rel="stylesheet">
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css" />  <link rel="stylesheet" href = "assets/css/ribbons.css">

</head>

<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      <!-- <div class="slide-wrapper"> -->
 <div class="slide " id="slide-1" style="background:">
 
  <div class="inner">
    <header>
      <h2>Introduction</h2>
    </header>
    
    <section>
      <h3>Problem Statement</h3>

<p>There has been growing concern about the amount of surplus military gear making its way to state and local law enforcement.  It first reached my attention as a resident of the Boston area after the Boston Marathon Bombing.  With the recent unrest in Ferguson, Il, the issue is getting increased coverage in the news.</p>

<h3>Goals</h3>

<p>The New York Times has filed a Freedom of Information Act request to get access to the list of gear that has been transferred from the Federal Government to state and local law enforcement agencies.  They have released the raw data on Github to allow others to explore.  I am using this project as a way to do just that.</p>

    </section>
    
  </div><!-- inner -->
  
  
 
  <div class="presenter_notes">
    <section>
      
    </section>
  </div><!-- presenter notes -->
  
  <div class="modal hide" id="source-1" style='display:none'>
    <div class="modal-body">
      <pre><code>
        --- 

## Introduction

### Problem Statement
There has been growing concern about the amount of surplus military gear making its way to state and local law enforcement.  It first reached my attention as a resident of the Boston area after the Boston Marathon Bombing.  With the recent unrest in Ferguson, Il, the issue is getting increased coverage in the news.

### Goals
The New York Times has filed a Freedom of Information Act request to get access to the list of gear that has been transferred from the Federal Government to state and local law enforcement agencies.  They have released the raw data on Github to allow others to explore.  I am using this project as a way to do just that.

      </code></pre>
    </div>
    <div class="modal-footer">
      <a class="btn" data-dismiss="modal" href="#">Close</a> 
      <a class="btn btn-primary" href="#">Save changes</a>
    </div>
  </div><!-- source -->
  
  <footer>
    <aside class="source">
      <a class="btn" data-toggle="modal" href="#source-">
        View Source
      </a>
    </aside>
    <aside class="page_number">
      1 / 
    </aside>
  </footer><!-- footer -->
  
 </div>
<!-- </div> -->
<!-- <div class="slide-wrapper"> -->
 <div class="slide class" id="id" style="background:">
 
  <div class="inner">
    <header>
      <h2>Notes on the data</h2>
    </header>
    
    <section>
      <ul>
<li>The data that has been made available on github is only down to the county level.  There is no indication as to which city or agency the equipment has been transferred to. This means:

<ul>
<li>If a state-level agency is concentrated in some counties, those counties will show as having more gear</li>
<li>There are many counties that had zero records, and show up as transparent on my plots.</li>
</ul></li>
<li>Each record has a National Stock Number identifier associated with it

<ul>
<li>can we do anything interesting with that data? (Time may not allow me to complete this before the due-date)</li>
<li>NSN&#39;s have a 4 digit prefix that correspond to a Federal Stock Category, which is itself a separate list of codes intended to categorize similar pieces of equipment.<br></li>
</ul></li>
</ul>

    </section>
    
  </div><!-- inner -->
  
  
 
  <div class="presenter_notes">
    <section>
      
    </section>
  </div><!-- presenter notes -->
  
  <div class="modal hide" id="source-2" style='display:none'>
    <div class="modal-body">
      <pre><code>
        ---  .class #id 

## Notes on the data

* The data that has been made available on github is only down to the county level.  There is no indication as to which city or agency the equipment has been transferred to. This means:
  * If a state-level agency is concentrated in some counties, those counties will show as having more gear
  * There are many counties that had zero records, and show up as transparent on my plots.
* Each record has a National Stock Number identifier associated with it
  * can we do anything interesting with that data? (Time may not allow me to complete this before the due-date)
  * NSN's have a 4 digit prefix that correspond to a Federal Stock Category, which is itself a separate list of codes intended to categorize similar pieces of equipment.  
      </code></pre>
    </div>
    <div class="modal-footer">
      <a class="btn" data-dismiss="modal" href="#">Close</a> 
      <a class="btn btn-primary" href="#">Save changes</a>
    </div>
  </div><!-- source -->
  
  <footer>
    <aside class="source">
      <a class="btn" data-toggle="modal" href="#source-">
        View Source
      </a>
    </aside>
    <aside class="page_number">
      2 / 
    </aside>
  </footer><!-- footer -->
  
 </div>
<!-- </div> -->
<!-- <div class="slide-wrapper"> -->
 <div class="slide class" id="id" style="background:">
 
  <div class="inner">
    <header>
      <h2>Approach</h2>
    </header>
    
    <section>
      <p>The New York Times has already implemented <a href="http://www.nytimes.com/2014/08/20/upshot/data-on-transfer-of-military-gear-to-police-departments.html?abt=0002&amp;abg=1&amp;_r=0">their own visualization</a> of the data.  My effort will be to create something that allows a visitor to do a slightly deeper exploration of the data. </p>

<h3>Initial Attempt</h3>

<p>The Googlevis package was the first thing I tried, but it does not have the ability to plot data at a county level. The next thing I found was the rMaps project, which is by the same author as the rCharts package.  Unfortunately rMaps is not working correctly and there don&#39;t seem to be any recent updates to the project.</p>

<h3>Solution</h3>

<p>Finally I found an article about how to plot county level data in ggplot2.  The solution extracts the geographic information that define the shapes of the counties and states, and draws the raw polygons to achieve the desired result.  The performance is quite slow, and it would have been nice to be able to use the rMaps package.</p>

    </section>
    
  </div><!-- inner -->
  
  
 
  <div class="presenter_notes">
    <section>
      
    </section>
  </div><!-- presenter notes -->
  
  <div class="modal hide" id="source-3" style='display:none'>
    <div class="modal-body">
      <pre><code>
        ---  .class #id 

## Approach

The New York Times has already implemented [their own visualization](http://www.nytimes.com/2014/08/20/upshot/data-on-transfer-of-military-gear-to-police-departments.html?abt=0002&amp;abg=1&amp;_r=0) of the data.  My effort will be to create something that allows a visitor to do a slightly deeper exploration of the data. 

### Initial Attempt
The Googlevis package was the first thing I tried, but it does not have the ability to plot data at a county level. The next thing I found was the rMaps project, which is by the same author as the rCharts package.  Unfortunately rMaps is not working correctly and there don't seem to be any recent updates to the project.

### Solution
Finally I found an article about how to plot county level data in ggplot2.  The solution extracts the geographic information that define the shapes of the counties and states, and draws the raw polygons to achieve the desired result.  The performance is quite slow, and it would have been nice to be able to use the rMaps package.
      </code></pre>
    </div>
    <div class="modal-footer">
      <a class="btn" data-dismiss="modal" href="#">Close</a> 
      <a class="btn btn-primary" href="#">Save changes</a>
    </div>
  </div><!-- source -->
  
  <footer>
    <aside class="source">
      <a class="btn" data-toggle="modal" href="#source-">
        View Source
      </a>
    </aside>
    <aside class="page_number">
      3 / 
    </aside>
  </footer><!-- footer -->
  
 </div>
<!-- </div> -->
<!-- <div class="slide-wrapper"> -->
 <div class="slide class" id="id" style="background:">
 
  <div class="inner">
    <header>
      <h2>Example: Florida</h2>
    </header>
    
    <section>
      <h3>Total cost of equipment transferred to Florida agencies</h3>

<p><img src="assets/fig/unnamed-chunk-1.png" alt="plot of chunk unnamed-chunk-1"> </p>

    </section>
    
  </div><!-- inner -->
  
  
 
  <div class="presenter_notes">
    <section>
      
    </section>
  </div><!-- presenter notes -->
  
  <div class="modal hide" id="source-4" style='display:none'>
    <div class="modal-body">
      <pre><code>
        ---  .class #id 
## Example: Florida

### Total cost of equipment transferred to Florida agencies
```{r, echo=FALSE, message=FALSE,warning=FALSE}

states &lt;- read.table(&quot;../states.csv&quot;, sep = &quot;,&quot;, quote=&quot;\&quot;&quot;, header=TRUE)
states$name &lt;- tolower(states$Name)
states$Abbr &lt;- tolower(states$Abbr)


mapcounties &lt;- map_data(&quot;county&quot;)
mapstates &lt;- map_data(&quot;state&quot;)

raw_data &lt;- read.table(&quot;../raw_data.csv&quot;, sep = &quot;,&quot;, quote=&quot;\&quot;&quot;, header=TRUE)


equip_data &lt;- raw_data
equip_data$state &lt;- tolower(equip_data$State)
equip_data$county &lt;- tolower(equip_data$County)

agg1 &lt;- aggregate(I(Quantity * Acquisition.Cost) ~ state + county, data=equip_data, FUN=sum )

colnames(agg1) &lt;- c(&quot;state&quot;,&quot;county&quot;,&quot;total&quot;)

#bins &lt;- quantile(agg1$total, 0:10/10,names=FALSE)
bins &lt;- c(0,10000,25000,50000,100000,1000000,10000000,100000000)
binLabels &lt;- c(&quot;&gt;$0&quot;,&quot;&gt;$10,000&quot;,&quot;&gt;$25,000&quot;,&quot;&gt;$50,000&quot;,&quot;&gt;$100,000&quot;,&quot;&gt;$1,000,000&quot;,&quot;&gt;$10,000,000&quot;,&quot;&gt;$100,000,000&quot;)

agg2 &lt;- agg1
agg2$bin &lt;- findInterval(agg2$total,bins)
agg2$bin2 &lt;- as.factor(bins[agg2$bin])
agg2$bin3 &lt;- formatC(agg2$bin2, format=&quot;d&quot;, big.mark=',')
agg2$bin4 &lt;- paste('$',agg2$bin3,sep='')

agg2 &lt;- merge(agg2,states,by.x=&quot;state&quot;,by.y=&quot;Abbr&quot;)
agg2$state.county &lt;- with(agg2,paste(name,county,sep=&quot;,&quot;))


mapcounties$county &lt;- with(mapcounties , paste(region, subregion, sep = &quot;,&quot;))
mergedata &lt;- merge(mapcounties, agg2, by.x = &quot;county&quot;, by.y = &quot;state.county&quot;)
mergedata &lt;- mergedata[order(mergedata$order),]


myColors2 &lt;- c( &quot;#EEF0FC&quot;,
  &quot;#B5BBDE&quot;,
  &quot;#929BCC&quot;,
  &quot;#7480BD&quot;,
  &quot;#5869B1&quot;,
  &quot;#3A53A8&quot;,
  &quot;#023FA5&quot; ,         
               &quot;#8A1923&quot;)

 chosenState &lt;- states[states$Name==&quot;Florida&quot;,]
        graphData &lt;- mergedata[mergedata$state==chosenState$Abbr,]
        graphCounties &lt;- mapcounties[mapcounties$region==chosenState$name,]
        graphStates &lt;- mapstates[mapstates$region==chosenState$name,]

map &lt;- ggplot(graphData, aes(long,lat,group=group)) + geom_polygon(aes(fill=bin2))
      map &lt;- map +
        coord_map(project=&quot;globular&quot;) +
        #scale_fill_brewer(palette=&quot;Accent&quot;)
        scale_fill_manual(values=myColors2,labels=binLabels,name=&quot;Total $&quot;)
    
        
      
      #draw state lines
      map &lt;- map + geom_path(data = graphStates, colour = &quot;white&quot;, size = .75)
      #draw county lines
      map &lt;- map + geom_path(data = graphCounties, colour = &quot;white&quot;, size = .5, alpha = .1)
      
      
      map

```
      </code></pre>
    </div>
    <div class="modal-footer">
      <a class="btn" data-dismiss="modal" href="#">Close</a> 
      <a class="btn btn-primary" href="#">Save changes</a>
    </div>
  </div><!-- source -->
  
  <footer>
    <aside class="source">
      <a class="btn" data-toggle="modal" href="#source-">
        View Source
      </a>
    </aside>
    <aside class="page_number">
      4 / 
    </aside>
  </footer><!-- footer -->
  
 </div>
<!-- </div> -->
<!-- <div class="slide-wrapper"> -->
 <div class="slide class" id="id" style="background:">
 
  <div class="inner">
    <header>
      <h3>References</h3>
    </header>
    
    <section>
      <ul>
<li>Github data: <a href="http://github.com/TheUpshot/Military-Surplus-Gear">http://github.com/TheUpshot/Military-Surplus-Gear</a></li>
<li>New York Times article: <a href="http://www.nytimes.com/2014/08/20/upshot/data-on-transfer-of-military-gear-to-police-departments.html?abt=0002&amp;abg=1&amp;_r=0">http://www.nytimes.com/2014/08/20/upshot/data-on-transfer-of-military-gear-to-police-departments.html?abt=0002&amp;abg=1&amp;_r=0</a></li>
<li>rMaps: <a href="https://github.com/ramnathv/rMaps">https://github.com/ramnathv/rMaps</a></li>
<li>Choropleth example: <a href="http://www.thisisthegreenroom.com/2009/choropleths-in-r/">http://www.thisisthegreenroom.com/2009/choropleths-in-r/</a></li>
<li>NSN/FSC information: <a href="http://www.everyspec.com/FSC-CODE/">http://www.everyspec.com/FSC-CODE/</a> (I had to hand-format this data)</li>
<li>Other: <a href="http://www.50states.com/abbreviations.htm#.U_lbYGOunwE">http://www.50states.com/abbreviations.htm#.U_lbYGOunwE</a></li>
</ul>

    </section>
    
  </div><!-- inner -->
  
  
 
  <div class="presenter_notes">
    <section>
      
    </section>
  </div><!-- presenter notes -->
  
  <div class="modal hide" id="source-5" style='display:none'>
    <div class="modal-body">
      <pre><code>
        ---  .class #id 
### References
* Github data: http://github.com/TheUpshot/Military-Surplus-Gear
* New York Times article: http://www.nytimes.com/2014/08/20/upshot/data-on-transfer-of-military-gear-to-police-departments.html?abt=0002&amp;abg=1&amp;_r=0
* rMaps: https://github.com/ramnathv/rMaps
* Choropleth example: http://www.thisisthegreenroom.com/2009/choropleths-in-r/
* NSN/FSC information: http://www.everyspec.com/FSC-CODE/ (I had to hand-format this data)
* Other: http://www.50states.com/abbreviations.htm#.U_lbYGOunwE


      </code></pre>
    </div>
    <div class="modal-footer">
      <a class="btn" data-dismiss="modal" href="#">Close</a> 
      <a class="btn btn-primary" href="#">Save changes</a>
    </div>
  </div><!-- source -->
  
  <footer>
    <aside class="source">
      <a class="btn" data-toggle="modal" href="#source-">
        View Source
      </a>
    </aside>
    <aside class="page_number">
      5 / 
    </aside>
  </footer><!-- footer -->
  
 </div>
<!-- </div> -->
    </div>
  </div>
  <div id="toc" class="sidebar">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
        <tr id="toc-row-1" class="">
        <th><a href="#slide1">Introduction</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      <tr id="toc-row-2" class="">
        <th><a href="#slide2">Notes on the data</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      <tr id="toc-row-3" class="">
        <th><a href="#slide3">Approach</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      <tr id="toc-row-4" class="">
        <th><a href="#slide4">Example: Florida</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      <tr id="toc-row-5" class="">
        <th><a href="#slide5">References</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
   </table>
  </div>  <div id="help" class="sidebar hidden">
  <h2>Help</h2>
  <table>
    <caption>Help</caption>
    <tr>
      <th>Table of Contents</th>
      <td>t</td>
    </tr>
    <tr>
      <th>Exposé</th>
      <td>ESC</td>
    </tr>
    <tr>
      <th>Full screen slides</th>
      <td>e</td>
    </tr>
    <tr>
      <th>Presenter View</th>
      <td>p</td>
    </tr>
    <tr>
      <th>Source Files</th>
      <td>s</td>
    </tr>
    <tr>
      <th>Slide Numbers</th>
      <td>n</td>
    </tr>
    <tr>
      <th>Toggle screen blanking</th>
      <td>b</td>
    </tr>
    <tr>
      <th>Show/hide slide context</th>
      <td>c</td>
    </tr>
    <tr>
      <th>Notes</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Help</th>
      <td>h</td>
    </tr>
  </table>
</div>
</body>
  <script 
    src="libraries/frameworks/landslide/themes/default/js/slides.js" type="text/javascript">
  </script>
  <script>main()</script>
  <!-- LOAD HIGHLIGHTER JS FILES -->
  <script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- DONE LOADING HIGHLIGHTER JS FILES -->
   
  </html>